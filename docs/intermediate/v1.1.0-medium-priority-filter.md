# v1.1.0 - Medium Priority Filter

**ðŸŽ¯ Goal:** Add `--medium` filter to complete priority filtering system

**ðŸ“¦ Problem Identified:**

Users could create medium priority tasks but couldn't filter by them:

```bash
# âœ… Can create medium priority
todo add "Normal task"              # Creates as medium (default)
todo add "Normal task" --medium     # Future: explicit medium

# âŒ Can't filter medium priority
todo list --high    # Works
todo list --low     # Works
todo list --medium  # Error: Invalid filter âŒ
```

**This was a design flaw** - asymmetry between creation and querying.

**ðŸ“¦ Implementation:**

```rust
"list" => {
    // ... existing code ...
    
    for arg in &args[2..] {
        match arg.as_str() {
            "--pending" => { /* ... */ }
            "--done" => { /* ... */ }
            "--high" => {
                if priority_filter.is_some() {
                    return Err("Use only one priority filter (--high, --medium or --low)".into());
                }
                priority_filter = Some("high");
            }
            "--medium" => {  // â† NEW
                if priority_filter.is_some() {
                    return Err("Use only one priority filter (--high, --medium or --low)".into());
                }
                priority_filter = Some("medium");
            }
            "--low" => {
                if priority_filter.is_some() {
                    return Err("Use only one priority filter (--high, --medium or --low)".into());
                }
                priority_filter = Some("low");
            }
            _ => return Err(format!("Invalid filter: {}", arg).into()),
        }
    }
    
    // ... filtering logic works automatically! ...
    
    // Dynamic title updated
    let title = match (status_filter, priority_filter) {
        ("pending", Some("high")) => "High priority pending tasks",
        ("pending", Some("medium")) => "Medium priority pending tasks",  // â† NEW
        ("pending", Some("low")) => "Low priority pending tasks",
        ("pending", None) => "Pending tasks",
        ("done", Some("high")) => "High priority completed tasks",
        ("done", Some("medium")) => "Medium priority completed tasks",  // â† NEW
        ("done", Some("low")) => "Low priority completed tasks",
        ("done", None) => "Completed tasks",
        (_, Some("high")) => "High priority",
        (_, Some("medium")) => "Medium priority",  // â† NEW
        (_, Some("low")) => "Low priority",
        _ => "Tasks",
    };
}
```

**ðŸ§  Key Concepts:**

### API Completeness Principle

**The problem:** Incomplete feature set

```rust
// Creation API (complete)
todo add "Task"        // Creates medium
todo add "Task" --high  // Creates high
todo add "Task" --low   // Creates low

// Query API (incomplete before v1.1.0)
todo list --high  // Works
todo list --low   // Works
todo list --medium // Missing! âŒ
```

**The solution:** Symmetric API design

```rust
// After v1.1.0 - complete symmetry
todo add "Task"        // Creates medium
todo add "Task" --high  // Creates high
todo add "Task" --low   // Creates low

todo list --high    // Queries high
todo list --medium  // Queries medium âœ… NEW
todo list --low     // Queries low
```

**Why this matters:**

- **Predictable** - Users can guess what works
- **Complete** - No "missing features"
- **Professional** - Polished API design

### Minimal Code Change

**Amazing fact:** Only added parsing logic, filtering worked automatically!

```rust
// extract_priority() already handled medium
fn extract_priority(line: &str) -> (&str, String) {
    // ... 
    if without_checkbox.contains("(high)") {
        ("high", text)
    } else if without_checkbox.contains("(low)") {
        ("low", text)
    } else {
        ("medium", without_checkbox)  // â† Already worked!
    }
}

// priority_emoji() already handled medium
fn priority_emoji(priority: &str) -> String {
    match priority {
        "high" => "ðŸ”´".red().to_string(),
        "low" => "ðŸŸ¢".green().to_string(),
        _ => "ðŸŸ¡".yellow().to_string(),  // â† Already worked for medium!
    }
}
```

**This is good architecture:**

- Functions were designed to handle all cases
- Adding new use case required minimal changes
- Existing code didn't need modification

### Error Message Consistency

**Updated all error messages to include "medium":**

```rust
// Before
return Err("Use only one priority filter (--high or --low)".into());

// After  
return Err("Use only one priority filter (--high, --medium or --low)".into());
```

**Why this matters:**

- **Accurate** - Error reflects actual capabilities
- **Helpful** - Shows user all valid options
- **Consistent** - All error messages updated

### Pattern Matching Exhaustiveness

**The match expression was already ready:**

```rust
let title = match (status_filter, priority_filter) {
    // ... existing patterns ...
    ("pending", Some("medium")) => "Medium priority pending tasks",  // Just add
    ("done", Some("medium")) => "Medium priority completed tasks",   // Just add
    (_, Some("medium")) => "Medium priority",                       // Just add
    // ... rest unchanged ...
};
```

**Rust's exhaustiveness checking helps:**

- Compiler warns if patterns are missing
- Forces complete coverage
- Prevents runtime panics

### Default Value Handling

**Medium is the "default" priority:**

```rust
// In extract_priority()
else {
    ("medium", without_checkbox)  // No explicit marker = medium
}
```

**This design choice:**

- **Common case** - Most tasks are medium priority
- **Simple** - No flags needed for normal tasks
- **Explicit** - High/low require explicit flags

### User Experience Flow

**Complete user journey now possible:**

```bash
# 1. Add tasks with different priorities
$ todo add "Urgent bug fix" --high
$ todo add "Documentation update" --medium  
$ todo add "Code cleanup" --low

# 2. Filter by each priority level
$ todo list --high
ðŸ“‹ High priority:
1. ðŸ”´ â³ Urgent bug fix

$ todo list --medium
ðŸ“‹ Medium priority:
1. ðŸŸ¡ â³ Documentation update

$ todo list --low
ðŸ“‹ Low priority:
1. ðŸŸ¢ â³ Code cleanup
```

**Before v1.1.0:** `todo list --medium` would error  
**After v1.1.0:** Complete workflow works seamlessly

### Testing Considerations

**What should be tested:**

```rust
// Test that medium filter works
todo add "Test task"  // Creates medium
todo list --medium   // Should show the task

// Test that medium tasks don't appear in other filters
todo list --high     // Should NOT show medium task
todo list --low      // Should NOT show medium task

// Test error messages
todo list --medium --high  // Should error about multiple filters
```

**Good architecture makes testing easy:**

- Each filter is independent
- Error conditions are clear
- Expected behavior is well-defined

### Future Extensibility

**Easy to add more priorities later:**

```rust
// Future: add critical priority
"--critical" => {
    if priority_filter.is_some() {
        return Err("Use only one priority filter (--critical, --high, --medium or --low)".into());
    }
    priority_filter = Some("critical");
}

// Update extract_priority()
if without_checkbox.contains("(critical)") {
    ("critical", text)
} else if without_checkbox.contains("(high)") {
    ("high", text)
// ... etc

// Update priority_emoji()
"critical" => "ðŸš¨".red().bold().to_string(),
```

**The pattern is established - just follow it.**

**ðŸ”— Resources:**

- [Code v1.1.0](https://github.com/joaofelipegalvao/todo-cli/tree/v1.1.0)
- [Full diff](https://github.com/joaofelipegalvao/todo-cli/compare/v1.0.0...v1.1.0)